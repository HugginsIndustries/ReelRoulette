<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ReelRoulette"
        x:Class="ReelRoulette.ItemTagsDialog"
        x:DataType="local:ItemTagsDialog"
        Title="Tags"
        Width="500"
        Height="500"
        WindowStartupLocation="CenterOwner"
        MinWidth="400"
        MinHeight="300">
    <Grid RowDefinitions="Auto * Auto Auto" Margin="12">
        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   x:Name="TitleTextBlock"
                   Text="Tags"
                   FontWeight="Bold"
                   FontSize="16"
                   Margin="0,0,0,16"/>

        <!-- Tags Grid -->
        <ScrollViewer Grid.Row="1"
                     VerticalScrollBarVisibility="Auto"
                     Margin="0,0,0,16">
            <ItemsControl x:Name="TagsItemsControl">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="4" Rows="0"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="local:TagViewModel">
                        <ToggleButton Content="{Binding Tag}"
                                      IsChecked="{Binding IsSelected}"
                                      Classes="IconToggle"
                                      Margin="4"
                                      Click="TagToggleButton_Click"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Add Tag Section -->
        <Grid Grid.Row="2"
              ColumnDefinitions="* Auto"
              ColumnSpacing="8"
              Margin="0,0,0,16">
            <TextBox x:Name="NewTagTextBox"
                     Grid.Column="0"
                     Watermark="Add new tag..."
                     KeyDown="NewTagTextBox_KeyDown"/>
            <Button Grid.Column="1"
                    Content="Add"
                    Click="AddTagButton_Click"
                    MinWidth="80"/>
        </Grid>

        <!-- Buttons -->
        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Spacing="8">
            <Button Content="Cancel"
                    Click="CancelButton_Click"
                    MinWidth="100"/>
            <Button Content="OK"
                    Click="OkButton_Click"
                    MinWidth="100"
                    IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>

