<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ReelRoulette"
        x:Class="ReelRoulette.ItemTagsDialog"
        x:DataType="local:ItemTagsDialog"
        Title="Tags"
        Width="750"
        Height="750"
        WindowStartupLocation="CenterOwner"
        MinWidth="400"
        MinHeight="300">
    <Grid RowDefinitions="* Auto Auto" Margin="12">
        <!-- Tags Grid -->
        <ScrollViewer Grid.Row="0"
                     VerticalScrollBarVisibility="Auto"
                     Margin="0,0,0,16">
            <ItemsControl x:Name="TagsItemsControl">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="3" Rows="0"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="local:BatchTagViewModel">
                        <Border Background="{Binding BackgroundBrush}"
                                CornerRadius="4"
                                Padding="8,6"
                                Margin="4">
                            <Grid ColumnDefinitions="* Auto Auto" ColumnSpacing="8">
                                <TextBlock Grid.Column="0"
                                          Text="{Binding Tag}"
                                          VerticalAlignment="Center"
                                          FontWeight="SemiBold"/>
                                <ToggleButton Grid.Column="1"
                                             Content="➕"
                                             IsChecked="{Binding IsPlusSelected}"
                                             Classes="IconToggleSmall"
                                             ToolTip.Tip="Add tag to all items"
                                             Click="PlusButton_Click"/>
                                <ToggleButton Grid.Column="2"
                                             Content="➖"
                                             IsChecked="{Binding IsMinusSelected}"
                                             Classes="IconToggleSmall"
                                             ToolTip.Tip="Remove tag from all items"
                                             Click="MinusButton_Click"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Add Tag Section -->
        <Grid Grid.Row="1"
              ColumnDefinitions="* Auto"
              ColumnSpacing="8"
              Margin="0,0,0,16">
            <TextBox x:Name="NewTagTextBox"
                     Grid.Column="0"
                     Watermark="Add new tag..."
                     KeyDown="NewTagTextBox_KeyDown"/>
            <Button Grid.Column="1"
                    Content="Add"
                    Click="AddTagButton_Click"
                    MinWidth="80"/>
        </Grid>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Spacing="8">
            <Button Content="Cancel"
                    Click="CancelButton_Click"
                    MinWidth="100"/>
            <Button Content="OK"
                    Click="OkButton_Click"
                    MinWidth="100"
                    IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>

